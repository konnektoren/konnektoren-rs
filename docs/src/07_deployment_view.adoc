ifndef::imagesdir[:imagesdir: ../images]

[[section-deployment-view]]
== Deployment View

=== Overview

The *konnektoren.help* platform uses a modern, cloud-native deployment model.
The frontend is a static WebAssembly (WASM) application hosted on GitHub Pages, delivered globally via Cloudflare CDN and proxy.
The backend leaderboard service is a Rust Axum server running inside a Docker container, communicating via REST API.

=== Infrastructure Level 1: High-Level Deployment

_**Deployment Overview Diagram**_

[plantuml, deployment-overview, svg]
....
@startuml deployment-overview
!define C4Deployment
C4Deployment

actor User

node "Cloudflare CDN & Proxy" {
  node "GitHub Pages" {
    [WASM Frontend]
  }
}

node "GitHub Actions" {
  [CI/CD Pipeline] <<Process>>
}

node "Backend Cluster" {
  node "Docker Host" {
    [Axum Leaderboard Server] <<Container>>
  }
}

User --> [Cloudflare CDN & Proxy] : HTTPS
[Cloudflare CDN & Proxy] --> [WASM Frontend] : Delivers static assets
[WASM Frontend] --> [Cloudflare CDN & Proxy] : API requests (REST)
[Cloudflare CDN & Proxy] --> [Axum Leaderboard Server] : Proxies REST API calls
[Axum Leaderboard Server] --> [Leaderboard Database] : Reads/Writes scores

[CI/CD Pipeline] --> [GitHub Pages] : Builds & deploys WASM Frontend

@enduml
....

**Motivation**

- Decentralized, scalable architecture for global reach and low latency.
- Separation of concerns: static frontend, containerized backend, and managed CDN/proxy.

**Quality & Performance Features**

- Cloudflare provides caching, DDoS protection, SSL termination, and global distribution.
- Docker enables reproducible, isolated, and scalable backend deployments.
- REST API ensures loose coupling between frontend and backend.

**Mapping of Building Blocks to Infrastructure**

[options="header",cols="1,2,2"]
|===
| Building Block         | Infrastructure Component         | Notes
| WASM Frontend          | GitHub Pages + Cloudflare CDN     | Built and deployed via GitHub Actions; static hosting, global delivery
| Axum Leaderboard       | Docker Host (Cloud/VM)            | Containerized Rust backend
| Leaderboard Database   | Managed DB (e.g., PostgreSQL)     | Persistent scores, scalable
| CDN/Proxy              | Cloudflare                        | Caching, SSL, API routing
|===

=== Infrastructure Level 2: Detailed Components

==== _GitHub Pages & Cloudflare CDN_

_**Frontend Hosting Diagram**_

[plantuml, github-pages-deployment, svg]
....
@startuml github-pages-deployment
node "GitHub Infrastructure" {
  [GitHub Pages] <<Static Hosting>>
}

node "Cloudflare CDN" {
  [CDN Edge Node]
}

node "User Browser" {
  [WASM Frontend]
}

[User Browser] --> [Cloudflare CDN] : HTTPS
[Cloudflare CDN] --> [GitHub Pages] : Fetches static assets
[Cloudflare CDN] --> [User Browser] : Delivers cached content

@enduml
....

- Users access the WASM frontend via Cloudflare, which caches and accelerates delivery.
- GitHub Pages hosts the static assets, with Cloudflare providing SSL and edge caching.

==== _Axum Server in Docker_

_**Backend Deployment Diagram**_

[plantuml, axum-server-deployment, svg]
....
@startuml axum-server-deployment
node "Cloud/VM Infrastructure" {
  node "Docker Host" {
    [Axum Leaderboard Server] <<Docker Container>>
  }
}

node "Leaderboard Database" {
  [Database] <<External System>>
}

[Axum Leaderboard Server] --> [Database] : REST/SQL
@enduml
....

- The Axum server runs in a Docker container, exposing REST APIs for leaderboard management.
- The backend communicates with a managed database (e.g., PostgreSQL, SQLite, or cloud DB).

=== Scaling, Monitoring, and Security

* **Scaling**: Docker containers can be replicated for horizontal scaling. Cloudflare automatically scales CDN delivery.
* **Monitoring**: Use Cloudflare analytics for traffic and health.
* **Security**: All traffic is encrypted (HTTPS). Cloudflare provides DDoS protection and WAF. Backend containers run as non-root and are regularly updated.

=== Deployment Automation

* **CI/CD**: GitHub Actions automates build, test, and deployment for both frontend and backend.
